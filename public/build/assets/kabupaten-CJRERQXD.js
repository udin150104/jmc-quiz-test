function k(){const u=new bootstrap.Modal(document.getElementById("form-modal")),f=new bootstrap.Modal(document.getElementById("delete-modal"));$(document).on("click","#btn-add",function(){$("#title-form").html("Tambah Data"),u.show()}),$(document).on("click",".btn-edit",function(){const t=$(this).data("id");$.get(`/application/referensi/kabupaten/${t}`,function(i){u.show(),$("#title-form").html("Ubah Data"),$('select[name="provinsi"]').val(i.provinsi_id),$('input[name="nama"]').val(i.nama),$("#form-data").attr("data-id",t)})});let p;$(document).on("click",".btn-delete",function(){p=$(this).data("id"),f.show()}),$(document).on("click",".delete-action",function(){$.ajax({url:`/application/referensi/kabupaten/${p}`,type:"DELETE",success:function(t){let i=$("#pagination .page-item.active .page-link").data("page")||1;r(i),$("#btn-batal-delete").trigger("click")},error:function(t){console.error(t.responseText)}})}),$(document).on("click","#submit-action",function(){$(".help").html("");const t=$("#form-data"),i=t.serialize(),n=t.attr("data-id"),l=n?`/application/referensi/kabupaten/${n}`:"/application/referensi/kabupaten",o=n?"PUT":"POST";$.ajax({url:l,method:o,data:i,success:function(c){let e=$("#pagination .page-item.active .page-link").data("page")||1;r(e),$("#btn-batal").trigger("click")},error:function(c){if(c.status===422){const e=c.responseJSON.errors;for(const a in e)$(`#${a}-help`).html(e[a][0])}}})}),$(document).on("click","#btn-batal",function(){$(".help").html(""),$("#form-data").get(0).reset(),$("#form-data").removeAttr("data-id",""),u.hide()}),$(document).on("click","#btn-batal-delete",function(){p=null,f.hide()});function b(t,i=5){const n=t.current_page,l=t.last_page;let o="";const c=(e,a=null,s=!1,d=!1)=>`
      <li class="page-item ${s?"active":""} ${d?"disabled":""} rounded-0">
        <a class="page-link  rounded-0" href="#" data-page="${d?"":e}">
          ${a??e}
        </a>
      </li>`;if(o+=c(n-1,'<i class="bi bi-caret-left"></i>',!1,n===1),l<=i+2)for(let e=1;e<=l;e++)o+=c(e,null,e===n);else{o+=c(1,null,n===1);let e=Math.max(2,n-Math.floor(i/2)),a=Math.min(l-1,n+Math.floor(i/2));e>2&&(o+='<li class="page-item disabled"><span class="page-link">…</span></li>');for(let s=e;s<=a;s++)o+=c(s,null,s===n);a<l-1&&(o+='<li class="page-item disabled"><span class="page-link">…</span></li>'),o+=c(l,null,n===l)}o+=c(n+1,'<i class="bi bi-caret-right"></i>',!1,n===l),$("#pagination").html(o)}$(document).on("click","#pagination .page-link",function(t){t.preventDefault();const i=parseInt($(this).data("page"));isNaN(i)||r(i)});function r(t=1){const i=$("#search").val(),n=$("#filter-provinsi").val();$.get("/application/referensi/kabupaten/api/data",{page:t,search:i,provinsi:n},function(l){let o="";const c=new Date,e=[];l.data.length>0?l.data.forEach(a=>{const s=a.created_at?a.created_at.replace(" ","T"):null;let d=!1;if(s){const g=new Date(s);d=c-g<=60*800}const m=`row-${a.id}`;d&&e.push(m),o+=`
          <tr id="${m}" class="${d?"table-info":""}">
            <td>${a.nama}</td>
            <td>${a.provinsi.nama}</td>
            <td class="text-center">
              <button type="button" class="btn btn-sm btn-secondary rounded-0 me-1 btn-edit" data-id="${a.id}">Ubah</button>
              <button type="button" class="btn btn-sm btn-danger rounded-0 btn-delete"  data-id="${a.id}">Hapus</button>
            </td>
          </tr>`}):o+='<tr><td colspan="3" class="text-muted">Belum Ada Data</td></tr>',$("#table-list tbody").html(o),b(l),e.forEach(a=>{setTimeout(()=>{$(`#${a}`).removeClass("table-info")},1e5)})})}r(1),$("#search").on("keyup",function(t){t.key==="Enter"&&r(1)}),$("#filter-provinsi").on("change",function(t){r(1)}),$("#btn-reset-filter").on("click",function(){$("#filter-provinsi").val(""),$("#search").val(""),$("#search").trigger(jQuery.Event("keyup",{key:"Enter",keyCode:13,which:13}))})}export{k as init};
