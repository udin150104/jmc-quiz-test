function k(){const m=new bootstrap.Modal(document.getElementById("form-modal")),p=new bootstrap.Modal(document.getElementById("delete-modal"));function f(t,n=5){const e=t.current_page,i=t.last_page;let a="";const l=(o,s=null,c=!1,u=!1)=>`
      <li class="page-item ${c?"active active-page":""} ${u?"disabled":""} rounded-0">
        <a class="page-link ${c?"":"text-dark"}  rounded-0" href="#" data-page="${u?"":o}">
          ${s??o}
        </a>
      </li>`;if(a+=l(e-1,'<i class="bi bi-caret-left"></i> Sebelumnya',!1,e===1),i<=n+2)for(let o=1;o<=i;o++)a+=l(o,null,o===e);else{a+=l(1,null,e===1);let o=Math.max(2,e-Math.floor(n/2)),s=Math.min(i-1,e+Math.floor(n/2));o>2&&(a+='<li class="page-item disabled"><span class="page-link">…</span></li>');for(let c=o;c<=s;c++)a+=l(c,null,c===e);s<i-1&&(a+='<li class="page-item disabled"><span class="page-link">…</span></li>'),a+=l(i,null,e===i)}a+=l(e+1,'Selanjutnya <i class="bi bi-caret-right"></i>',!1,e===i),$("#pagination").html(a)}$(document).on("click","#pagination .page-link",function(t){t.preventDefault();const n=parseInt($(this).data("page"));isNaN(n)||d(n)});let r="ASC",b;$(document).on("click",".sort",function(){b=$(this).data("order"),r=r==="ASC"?"DESC":"ASC";const t=$(this),n=t.clone().children().remove().end().text().trim(),e=r==="ASC"?' <i class="bi bi-arrow-up"></i>':' <i class="bi bi-arrow-down"></i>';$(".sort").each(function(){const i=$(this).clone().children().remove().end().text().trim();$(this).html(i)}),t.html(e+n),d(1)}),d(1);function d(t=1){const n=$("#search").val();$.get("/application/master/sub-kategori/api/data",{page:t,search:n,sortBy:b,sort:r},function(e){let i="";e.data.length>0?e.data.forEach((a,l)=>{a.created_at&&a.created_at.replace(" ","T");const o=`row-${a.id}`;let s=t>1?`${t} ${l+1}`:l+1,u=a.limit_price.replace(/[^0-9]/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,".");i+=`
          <tr id="${o}" >
            <td class="text-center">${s}</td>
            <td class="text-center">
              <button type="button" class="btn btn-sm rounded-0 me-1 btn-edit" data-id="${a.id}">
                <i class="bi bi-pencil"></i>
              </button>
              <button type="button" class="btn btn-sm text-danger rounded-0 btn-delete"  data-id="${a.id}">
                <i class="bi bi-trash"></i>
              </button>
            </td>
            <td>${a.kategori.nama}</td>
            <td>${a.nama}</td>
            <td class="text-end">${u}</td>
          </tr>`}):i+='<tr><td colspan="5" class="text-muted">Belum Ada Data</td></tr>',$("#table-list tbody").html(i),f(e)})}$(document).on("click","#btn-search",function(){d(1)}),$("#search").on("keyup",function(t){t.key==="Enter"&&d(1)}),$(document).on("click","#btn-add",function(){m.show()}),$(document).on("click",".btn-batal",function(){$(".help").html(""),$("#form-data").get(0).reset(),$("#form-data").removeAttr("data-id",""),m.hide()}),$(document).on("click","#submit-action",function(){$(".help").html("");const t=$("#form-data"),n=t.serialize(),e=t.attr("data-id"),i=e?`/application/master/sub-kategori/${e}`:"/application/master/sub-kategori",a=e?"PUT":"POST";$.ajax({url:i,method:a,data:n,success:function(l){let o=l.message;$("#toast-message").show(),$("#toast-message .toast-body").html(o);let s=$("#pagination .page-item.active .page-link").data("page")||1;d(s),$(".btn-batal").trigger("click"),setTimeout(function(){$("#toast-message").hide(),$("#toast-message .toast-body").html("")},5e3)},error:function(l){if(l.status===422){const o=l.responseJSON.errors;for(const s in o)$(`#${s}-help`).html(o[s][0])}}})}),$(document).on("click",".btn-edit",function(){const t=$(this).data("id");$.get(`/application/master/sub-kategori/${t}`,function(n){m.show();let i=n.limit_price.replace(/[^0-9]/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,".");$('input[name="batas"]').val(i),$('select[name="kategori"]').val(n.kategori_id),$('input[name="nama"]').val(n.nama),$("#form-data").attr("data-id",t)})});let g;$(document).on("click","#btn-batal-delete",function(){g=null,p.hide()}),$(document).on("click",".btn-delete",function(){g=$(this).data("id"),p.show()}),$(document).on("click",".delete-action",function(){$.ajax({url:`/application/master/sub-kategori/${g}`,type:"DELETE",success:function(t){let n=t.message;$("#toast-message").show(),$("#toast-message .toast-body").html(n);let e=$("#pagination .page-item.active .page-link").data("page")||1;d(e),$("#btn-batal-delete").trigger("click"),setTimeout(function(){$("#toast-message").hide(),$("#toast-message .toast-body").html("")},5e3)},error:function(t){console.error(t.responseText)}})});const h=document.getElementById("batas");h.addEventListener("input",function(){let t=this.value.replace(/[^0-9]/g,"");t=t.replace(/\B(?=(\d{3})+(?!\d))/g,"."),this.value=t}),h.addEventListener("blur",function(){this.value.replace(/[^0-9]/g,"")||(this.value="")})}export{k as init};
