function b(){function p(){return`
      <tr>
        <td class="pe-2 pt-2"><input type="text" class="form-control rounded-0" name="nama_item[]"></td>
        <td class="pe-2 pt-2"><input type="text" class="form-control text-end rounded-0 currency" placeholder="Rp." name="harga[]"></td>
        <td class="pe-2 pt-2"><input type="number" class="form-control rounded-0" min="1" name="jumlah[]" value="1"></td>
        <td class="pe-2 pt-2"><input type="text" class="form-control rounded-0" name="satuan[]"></td>
        <td class="pe-2 pt-2"><input type="text" class="form-control form-control-plaintext text-end px-2 currency rounded-0" readonly disabled placeholder="Rp." name="total[]"></td>
        <td class="pe-2 pt-2"><input type="text" class="form-control rounded-0 datepicker" name="tgl_expired[]"></td>
        <td class="pt-2"><button type="button" class="btn rounded-0 btn-remove-row"><i class="bi bi-x-circle-fill text-danger"></i></button></td>
      </tr>
    `}function u(t,n="Rp. "){let a=t.toString().replace(/[^,\d]/g,"").split(","),i=a[0].length%3,o=a[0].substr(0,i),d=a[0].substr(i).match(/\d{3}/gi);return d&&(o+=(i?".":"")+d.join(".")),n+o}function l(t){return parseInt(t.replace(/[^0-9]/g,""))||0}function c(t){const n=l(t.find('input[name="harga[]"]').val()),e=parseInt(t.find('input[name="jumlah[]"]').val())||0;if(n&&e){const a=n*e;t.find('input[name="total[]"]').val(u(a))}else t.find('input[name="total[]"]').val("");r()}function r(){const t=l($("#batas").val());let n=0,e=null,a=0;$("tr").each(function(){const i=$(this).find('input[name="total[]"]');if(i.length>0){const o=l(i.val());n+=o,e=$(this),a=o}}),t>0&&n>t&&n-a<t&&(alert("Total keseluruhan melebihi batas barang yang diizinkan!"),e.find('input[name="harga[]"]').val("").focus(),e.find('input[name="total[]"]').val(""),e.find('input[name="jumlah[]"]').val("1"))}function s(){flatpickr(".datepicker",{dateFormat:"d/m/Y",locale:"id",allowInput:!0,appendTo:document.body,onOpen:function(t,n,e){setTimeout(()=>e.calendarContainer.classList.add("open"),10)},yearSelectorType:"dropdown"})}function m(){$(document).on("click",".btn-remove-row",function(){$(this).closest("tr").remove(),r()}),$(document).on("click","#add-row-table",function(){$("#list-item").append(p()),s(),r()}),$(document).on("input",".currency",function(){$(this).val(u($(this).val()))}),$(document).on("keypress",".currency",function(t){/[0-9,]/.test(String.fromCharCode(t.which))||t.preventDefault()}),$(document).on("keydown",'input[type="number"]',function(t){const n=[46,8,9,27,13,37,38,39,40],e=t.ctrlKey||t.metaKey,a=[65,67,86,88];n.includes(t.keyCode)||e&&a.includes(t.keyCode)||(t.shiftKey||t.keyCode<48||t.keyCode>57)&&(t.keyCode<96||t.keyCode>105)&&t.preventDefault()}),$(document).on("paste",'input[type="number"]',function(t){const n=(t.originalEvent||t).clipboardData.getData("text");/^\d+$/.test(n)||t.preventDefault()}),$(document).on("input",'input[name="harga[]"], input[name="jumlah[]"]',function(){c($(this).closest("tr"))}),$(document).on("change",'input[name="jumlah[]"]',function(){c($(this).closest("tr"))}),$(document).on("input",'input[name="harga[]"]',function(){const t=this.selectionStart,n=l($(this).val()).toString();$(this).val(u(n)),this.setSelectionRange(t,t)}),$(document).on("keypress",'input[name="harga[]"]',function(t){/[0-9]/.test(String.fromCharCode(t.which))||t.preventDefault()}),$(document).on("keypress",'input[name="satuan[]"]',function(t){/^[a-zA-Z\s]+$/.test(String.fromCharCode(t.which))||t.preventDefault()}),$(document).on("paste",'input[name="satuan[]"]',function(t){const n=(t.originalEvent||t).clipboardData.getData("text");/^[a-zA-Z\s]+$/.test(n)||t.preventDefault()}),$(document).on("input","#batas",function(){r()}),$(document).on("click","#submit-action",function(t){const n=l($("#batas").val());let e=0;$('input[name="total[]"]').each(function(){e+=l($(this).val())}),n>0&&e>n&&(t.preventDefault(),alert("Total keseluruhan melebihi batas yang diizinkan!"))})}function f(t,n="#subkategori",e=null){$.get("/application/api/get-sub-kategori-by-kategori",{kategori:t},function(a){let i='<option value="" hidden>Pilih Sub kategori</option>';a.length?a.forEach(o=>{i+=`<option value="${o.id}" data-limit="${o.limit_price}">${o.nama}</option>`}):i+='<option value="" disabled>Belum ada data</option>',$(n).html(i),typeof e=="function"&&e()})}function h(){$("#kategori").on("change",function(){const t=$(this).val();$("#subkategori").html(""),f(t),$("#batas").val("Pilih Sub Kategori Terlebih Dahulu")}),$("#subkategori").on("change",function(){const t=$(this).find("option:selected").data("limit");$("#batas").val(u(t)).trigger("input")})}s(),m(),h()}export{b as init};
