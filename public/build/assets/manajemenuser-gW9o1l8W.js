function w(){const b=new bootstrap.Modal(document.getElementById("form-modal")),p=new bootstrap.Modal(document.getElementById("delete-modal")),f=new bootstrap.Modal(document.getElementById("lock-user-modal"));function k(t,n=5){const a=t.current_page,s=t.last_page;let i="";const e=(o,l=null,d=!1,m=!1)=>`
      <li class="page-item ${d?"active active-page":""} ${m?"disabled":""} rounded-0">
        <a class="page-link ${d?"":"text-dark"}  rounded-0" href="#" data-page="${m?"":o}">
          ${l??o}
        </a>
      </li>`;if(i+=e(a-1,'<i class="bi bi-caret-left"></i> Sebelumnya',!1,a===1),s<=n+2)for(let o=1;o<=s;o++)i+=e(o,null,o===a);else{i+=e(1,null,a===1);let o=Math.max(2,a-Math.floor(n/2)),l=Math.min(s-1,a+Math.floor(n/2));o>2&&(i+='<li class="page-item disabled"><span class="page-link">…</span></li>');for(let d=o;d<=l;d++)i+=e(d,null,d===a);l<s-1&&(i+='<li class="page-item disabled"><span class="page-link">…</span></li>'),i+=e(s,null,a===s)}i+=e(a+1,'Selanjutnya <i class="bi bi-caret-right"></i>',!1,a===s),$("#pagination").html(i)}$(document).on("click","#pagination .page-link",function(t){t.preventDefault();const n=parseInt($(this).data("page"));isNaN(n)||c(n)});let u="ASC",h;$(document).on("click",".sort",function(){h=$(this).data("order"),u=u==="ASC"?"DESC":"ASC";const t=$(this),n=t.clone().children().remove().end().text().trim(),a=u==="ASC"?' <i class="bi bi-arrow-up"></i>':' <i class="bi bi-arrow-down"></i>';$(".sort").each(function(){const s=$(this).clone().children().remove().end().text().trim();$(this).html(s)}),t.html(a+n),c(1)}),c(1);function c(t=1){const n=$("#search").val(),a=$("#filter-role").val();$.get("/application/manajemen-user/api/data",{page:t,search:n,sortBy:h,sort:u,role:a},function(s){let i="";s.data.length>0?s.data.forEach((e,o)=>{e.created_at&&e.created_at.replace(" ","T");const l=`row-${e.id}`;let d=t>1?`${t} ${o+1}`:o+1,m;e.isbanned?m="Anda yakin ingin memberikan izin login user ini? jika ya, maka user ini akan dapat login kembali ke sistem.":m="Anda yakin ingin melarang user ini? jika ya, maka user ini tidak akan bisa login ke sistem.";let y=e.isbanned?"bi-unlock":"bi-lock",g="";e.islogin===!1&&(g=`
              <button type="button" class="btn btn-sm rounded-0 btn-edit" data-id="${e.id}">
                <i class="bi bi-pencil"></i>
              </button>              
              <button type="button" class="btn btn-sm rounded-0 btn-lock-user" data-message="${m}" data-id="${e.id}">
                <i class="bi ${y}"></i>
              </button>           
              <button type="button" class="btn btn-sm text-danger rounded-0 btn-delete"  data-id="${e.id}">
                <i class="bi bi-trash"></i>
              </button>
              `),e.islogin&&(g=`
              <button type="button" class="btn btn-sm rounded-0 me-1 btn-edit" data-id="${e.id}">
                <i class="bi bi-pencil"></i>
              </button>   
              `),i+=`
          <tr id="${l}" >
            <td class="text-center">${d}</td>
            <td class="text-center">${g}</td>
            <td>${e.username}</td>
            <td>${e.name}</td>
            <td>${e.email}</td>
            <td>${e.roles[0].nama}</td>
          </tr>`}):i+='<tr><td colspan="4" class="text-muted">Belum Ada Data</td></tr>',$("#table-list tbody").html(i),k(s)})}$(document).on("click","#btn-search",function(){c(1)}),$("#search").on("keyup",function(t){t.key==="Enter"&&c(1)}),$(document).on("click","#btn-add",function(){b.show()}),$(document).on("click",".btn-batal",function(){$(".help").html(""),$("#form-data").get(0).reset(),$("#form-data").removeAttr("data-id",""),$("#password-info").addClass("d-none"),b.hide()}),$(document).on("click","#submit-action",function(){$(".help").html("");const t=$("#form-data"),n=t.serialize(),a=t.attr("data-id"),s=a?`/application/manajemen-user/${a}`:"/application/manajemen-user",i=a?"PUT":"POST";$.ajax({url:s,method:i,data:n,success:function(e){let o=e.message;$("#toast-message").show(),$("#toast-message .toast-body").html(o);let l=$("#pagination .page-item.active .page-link").data("page")||1;c(l),$(".btn-batal").trigger("click"),setTimeout(function(){$("#toast-message").hide(),$("#toast-message .toast-body").html("")},5e3)},error:function(e){if(e.status===422){const o=e.responseJSON.errors;for(const l in o)$(`#${l}-help`).html(o[l][0])}}})}),$(document).on("click",".btn-edit",function(){const t=$(this).data("id");$.get(`/application/manajemen-user/${t}`,function(n){$("#password-info").removeClass("d-none"),b.show(),$('select[name="role"]').val(n.roles[0].id),$('input[name="name"]').val(n.name),$('input[name="username"]').val(n.username),$('input[name="email"]').val(n.email),$("#form-data").attr("data-id",t)})});let r;$(document).on("click","#btn-batal-delete",function(){r=null,p.hide()}),$(document).on("click",".btn-delete",function(){r=$(this).data("id"),p.show()}),$(document).on("click",".delete-action",function(){$.ajax({url:`/application/manajemen-user/${r}`,type:"DELETE",success:function(t){let n=t.message;$("#toast-message").show(),$("#toast-message .toast-body").html(n);let a=$("#pagination .page-item.active .page-link").data("page")||1;c(a),$("#btn-batal-delete").trigger("click"),setTimeout(function(){$("#toast-message").hide(),$("#toast-message .toast-body").html("")},5e3)},error:function(t){console.error(t.responseText)}})}),$(document).on("click",".btn-lock-user",function(){f.show(),r=$(this).data("id");let t=$(this).data("message");$("#lock-user-modal .modal-body").html(t)}),$(document).on("click","#btn-batal-lock",function(){r=null,f.hide()}),$(document).on("click",".lock-unlock-action",function(){$.ajax({url:`/application/manajemen-user/lock-unlock/${r}`,type:"POST",success:function(t){let n=t.message;$("#toast-message").show(),$("#toast-message .toast-body").html(n);let a=$("#pagination .page-item.active .page-link").data("page")||1;c(a),$("#btn-batal-lock").trigger("click"),setTimeout(function(){$("#toast-message").hide(),$("#toast-message .toast-body").html("")},5e3)},error:function(t){console.error(t.responseText)}})}),$("#filter-role").on("change",function(t){c(1)})}export{w as init};
